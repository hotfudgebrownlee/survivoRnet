---
title: "Survivor Inspiration Network"
author: "Jaren Brownlee"
output:
  html_document:  
    keep_md: true
    toc: true
    toc_float: true
    code_folding: hide
    fig_height: 6
    fig_width: 12
    fig_align: 'center'
---

```{r, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r load_libraries, include=FALSE}
library(tidyverse)
library(survivoR)
```

```{r load_data}
selfCompare <- read_csv("./selfCompare.csv", show_col_types = FALSE) %>% 
  select(-c(gender)) %>% fill(season) %>%
  pivot_longer(3:9, values_to="inspiration") %>% select(-c(name)) %>%
  filter(!is.na(inspiration)) %>%
  separate(inspiration, into = c('inspFirst', 'inspLast'),
           sep=" ", extra="merge", remove=FALSE)
```

## Data Wrangling

```{r tidy_data}
fullNames <- castaway_details %>% 
  merge((castaways %>% select(c(castaway_id, version_season))), 
        by="castaway_id") %>%
  mutate(full_name = case_when(
    castaway_id == "US0281" ~ "JT Thomas", 
    castaway_id == "US0029" ~ "Elisabeth Hasselbeck",
    TRUE ~ full_name)) %>%
  separate(full_name, into = c('first','last'), 
    sep = " ", extra = "merge", remove = FALSE) %>%
  mutate(name = case_when(
    str_detect(full_name,short_name) ~ str_c(first, ' ', last),
    TRUE ~ str_c(first, ' "', short_name, '" ', last))) %>%
  select(castaway_id, full_name, first, short_name, last) %>%
  merge((selfCompare %>% select(c(inspiration, inspFirst, inspLast))),
        by.x="last", by.y="inspLast", all=TRUE) %>% unique() %>%
  mutate(inspiration = case_when(
    !is.na(inspiration) ~ inspiration,
    str_detect(short_name, first) ~ full_name,
    short_name == last ~ full_name,
    castaway_id == "US0302" ~ full_name,
    castaway_id == "US0305" ~ "Jimmy Tarantino",
    TRUE ~ str_c(short_name, last, sep=" "))) %>%
  mutate(fullName = case_when(
    is.na(inspFirst) ~ inspiration,
    full_name == inspiration ~ full_name,
    short_name == inspFirst ~ inspiration,
    short_name == "Shan" ~ str_c(short_name, last, sep=" "),
    str_detect(full_name, short_name) ~ full_name,
    TRUE ~ str_c(short_name, last, sep=" "))) %>%
  rename(shortName = short_name) %>%
  left_join(castaways, by="castaway_id") %>% unique() %>%
  mutate(season = substr(version_season,3,4)) %>%
  select(season, castaway_id, first, shortName, last, fullName)

selfCompare <- selfCompare %>% select(-c(inspFirst, inspLast)) %>% 
  mutate(season = substr(season,8,9)) %>%
  left_join(fullNames,  by=c("season"="season", "castaway"="shortName")) %>%
  rename(cast_name = fullName, cast_id = castaway_id) %>%
  select(cast_id, cast_name, inspiration) %>%
  left_join(fullNames, by=c("inspiration"="fullName")) %>%
  rename(inspo_name = inspiration, inspo_id = castaway_id) %>%
  select(cast_id, cast_name, inspo_id, inspo_name) %>% unique()
```

## Data Visualization

```{r plot_data}

```
